# Система VideoDataAnalysis проекта "Сохранная доставка"
Django-сервер, где будут размещены разработанные модели обработки видеоданных.
Доступно:
 - распознавание 80 классов из датасета COCO на основе обученной нейронной сети YOLOv5;
 - распознавание 4 классов (сливной шланг, канистра, бутыль, ведро);
 - построение интерактивных графиков на основе данных из Geocode, выгруженные в .xsls формате, на основе библиотеки bokeh.

В разработке:
- распознавание автомобильных номеров на основе библиотеки nomeroff-net, интеграция с проектом SAVA.

# Запуск сервера из исходного кода
1. Обновить драйвер графического процессора
2. Установить CUDA версию не ниже 10.2
```
https://developer.nvidia.com/cuda-10.2-download-archive
```
3. Скачать репозиторий (master ветка)
4. Перейти в корневую директорию проекта:
```
cd safedelivery-vda/
```
5. Установить необходимые пакеты из файла requirements.txt:
```
pip install -r requirements.txt
```
6. Запустить сервер через команду:
```
python manage.py runserver
```
По умолчанию сервер будет доступен по адресу 127.0.0.1:8000. Для запуска сервера на другом порту 127.0.0.1:<custom_port> следует выполнить
```
python manage.py runserver <custom_port>
```
7. В браузере (желательно Google Chrome) перейти по адресу 127.0.0.1:<custom_port>. 
    7.1 Справа сверху выбрать раздел «Интеллектуальный анализ данных»
    7.2 Перейти по ссылке «Распознавание объектов на видео». При этом откроется новая вкладка с соответствующим функционалом
    7.3 В новой вкладке формируются 2 столбца – слева оригинальные загруженные примеры видеозаписей, справа – проанализированные нейронной сетью с отрисованными распознанными объектами. 
    7.4 Необходимо загрузить видеозапись через форму загрузки в справом верхнем углу. Формат видео предпочтительно .mp4, .avi. Максимальный размер видеозаписи - 1 Гб. 
    7.5 Видео можно скачать, нажав правой клавишей мыши и выбрав опцию «Сохранить ссылку как».
Для экономии времени можно не загружать видео через форму, а выбрать видео в левом списке из числа уже загруженных (тестовое видео под именем demo_video.mp4), затем выбрать объекты для отрисовки и затем нажать на кнопку «Запустить процесс распознавания».
После того, как строка прогресса дойдет до 100%, нужно обновить страницу. В списке проанализированных видеозаписей справа появится новая запись, в имени которой будет фигурировать дата и имя оригинального файла. Данное видео также можно скачать, нажав на него правой клавишей мыши и выбрав опцию «Сохранить ссылку как».

# Запуск сервера через docker
1. Скачать docker-контейнер. В командной строке выполнить
```
docker 
```
